<!DOCTYPE html>
<!-- Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements. See the NOTICE file distributed with this work for additional information regarding 
	copyright ownership. The ASF licenses this file to you under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may 
	obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0 Unless required by applicable law or agreed to in writing, software distributed under the License is distributed 
	on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the 
	License. -->
<html>
<head>
<meta charset="utf-8" />
<meta name="format-detection" content="telephone=no" />
<!-- WARNING: for iOS 7, remove the width=device-width and height=device-height attributes. See https://issues.apache.org/jira/browse/CB-4323 -->
<meta name="viewport"
	content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />

<link rel="stylesheet" href="css/jquery.mobile-1.4.5.min.css">
<link rel="stylesheet" type="text/css" href="css/main.css" />
<link rel="stylesheet" type="text/css" href="css/springboard.css" />
<link rel="stylesheet" type="text/css" href="css/metis.css" />

<link rel="stylesheet" href="css/Bootstrap.min.css">
<link rel="stylesheet" href="css/snap.css">
<link rel="stylesheet" href="css/demo.css">
<link rel="stylesheet" href="css/accordionmenu.css">

<link href="font-awesome-4.0.3/css/font-awesome.min.css"
	rel="stylesheet">
<link href='http://fonts.googleapis.com/css?family=News+Cycle:400,700'
	rel='stylesheet' type='text/css'>
<link href="http://fonts.googleapis.com/css?family=Lobster"
	rel="stylesheet" type="text/css">

<script src="js/jquery.js"></script>
<script src="js/jquery.mobile-1.4.5.min.js"></script>
<script src="js/jquery.mask.min.js"></script>
<script src="js/main.js"></script>
<script src="js/snap.js"></script>
<script src="js/swipe.js"></script>
<script src="js/deviceCheck.js"></script>
<script src="js/springboard.js"></script>
<script src="js/metis.js"></script>
<script src="js/accordionmenu.js"></script>
<script src="js/less-1.6.1.min.js" type="text/javascript"></script>
<script src="js/go.js"></script>

<script id="code">
  function init() {
		var nomePerfil = "";
		//montaPopup();
	    jQuery("#select-carreiras").bind( "change", function(event, ui) {
			nomePerfil =  jQuery("#select-carreiras").val();
	    });
	    jQuery("#select-perfil").bind( "change", function(event, ui) {
			nomePerfil =  jQuery("#select-carreiras").val();
	    });
	    jQuery("#novoObjeto").bind( "click", function(event, ui) {
			jQuery( "#nodeObjectChange" ).popup( "close" );
			jQuery( "#newNodeObject" ).popup( "open" );
	    });

	    jQuery(".close").bind( "click", function(event, ui) {
			jQuery( "#nodeObjectChange" ).popup( "close" );
			jQuery( "#newNodeObject" ).popup( "close" );
	    });

    if (window.goSamples) goSamples();  // init for these samples -- you don't need to call this
    var $ = go.GraphObject.make;  // for conciseness in defining templates
    myDiagram =
      $(go.Diagram, "myDiagram",  // create a Diagram for the DIV HTML element
        {
          // position the graph in the middle of the diagram
          initialContentAlignment: go.Spot.Center,
          // allow double-click in background to create a new node
          "clickCreatingTool.archetypeNodeData": { text: "Node", color: "white" },
          // allow Ctrl-G to call groupSelection()
          "commandHandler.archetypeGroupData": { text: "Group", isGroup: true, color: "blue" },
          // enable undo & redo
          "undoManager.isEnabled": true,
          "ChangedSelection": onSelectionChanged,
          "TextEdited": onTextEdited
        });
    // Define the appearance and behavior for Nodes:
    // First, define the shared context menu for all Nodes, Links, and Groups.
    // To simplify this code we define a function for creating a context menu button:
    function makeButton(text, action, visiblePredicate) {
      return $("ContextMenuButton",
               $(go.TextBlock, text),
               { click: action },
               // don't bother with binding GraphObject.visible if there's no predicate
               visiblePredicate ? new go.Binding("visible", "", visiblePredicate).ofObject() : {});
    }
    // a context menu is an Adornment with a bunch of buttons in them
    var partContextMenu =
      $(go.Adornment, "Vertical",
          makeButton("Properties",
                     function(e, obj) {  // OBJ is this Button
                       var contextmenu = obj.part;  // the Button is in the context menu Adornment
                       var part = contextmenu.adornedPart;  // the adornedPart is the Part that the context menu adorns
                       // now can do something with PART, or with its data, or with the Adornment (the context menu)
                       if (part instanceof go.Link) alert(linkInfo(part.data));
                       else if (part instanceof go.Group) alert(groupInfo(contextmenu));
                       else alert(nodeInfo(part.data));
                     }),
          makeButton("Cut",
                     function(e, obj) {
        	  e.diagram.commandHandler.cutSelection(); 
        	  },
                     function(o) {
        		  return o.diagram.commandHandler.canCutSelection(); 
        		  }),
          makeButton("Copy",
                     function(e, obj) {
        	  e.diagram.commandHandler.copySelection(); 
        	  },
                     function(o) {
        		  return o.diagram.commandHandler.canCopySelection();
        		  }),
          makeButton("Paste",
                     function(e, obj) {
        	  e.diagram.commandHandler.pasteSelection(e.diagram.lastInput.documentPoint);
        	  },
                     function(o) {
        		  return o.diagram.commandHandler.canPasteSelection(); 
        		  }),
          makeButton("Delete",
                     function(e, obj) {
        	  e.diagram.commandHandler.deleteSelection(); 
        	  },
                     function(o) {
        		  return o.diagram.commandHandler.canDeleteSelection(); 
        		  }),
          makeButton("Undo",
                     function(e, obj) {
        	  e.diagram.commandHandler.undo(); 
        	  },
                     function(o) {
        		  return o.diagram.commandHandler.canUndo(); 
        		  }),
          makeButton("Redo",
                     function(e, obj) {
        	  e.diagram.commandHandler.redo(); 
        	  },
                     function(o) {
        		  return o.diagram.commandHandler.canRedo();
        		  }),
          makeButton("Group",
                     function(e, obj) {
        	  e.diagram.commandHandler.groupSelection();
        	  },
                     function(o) {
        		  return o.diagram.commandHandler.canGroupSelection(); 
        		  }),
          makeButton("Ungroup",
                     function(e, obj) {
        	  e.diagram.commandHandler.ungroupSelection(); 
        	  },
                     function(o) {
        		  return o.diagram.commandHandler.canUngroupSelection(); 
        		  })
      );
    function nodeInfo(d) {  // Tooltip info for a node data object
      var str = "Node " + d.key + ": " + d.text + "\n";
      if (d.group)
        str += "member of " + d.group;
      else
        str += "top-level node";
      return str;
    }
    
    // when a node is double-clicked, add a child to it
    function nodeDoubleClick(e, obj) {
        var clicked = obj.part;
        if (clicked !== null) {
          var thisemp = clicked.data;
          myDiagram.startTransaction("add employee");
          var nextkey = (myDiagram.model.nodeDataArray.length + 1).toString();
          var newemp = { key: nextkey, name: "(new person)", title: "", parent: thisemp.key };
          myDiagram.model.addNodeData(newemp);
          myDiagram.commitTransaction("add employee");
        }    
        }
    
    function onSelectionChanged(e) {
    	jQuery( "#nodeObjectChange" ).popup( "open" );
        var node = e.diagram.selection.first();
        if (node instanceof go.Node) {
          updateProperties(node.data);
        } else {
          updateProperties(null);
        }
      }
    // Update the HTML elements for editing the properties of the currently selected node, if any
    function updateProperties(data) {
      if (data === null) {
        console.log ("click null");
      } else {
    	  console.log("key "  + data.key );
    	  console.log("text " + data.text );
    	  console.log("color " + data.color );
    	  console.log("id " + data.id );
      }
    }
    // This is called when the user has finished inline text-editing
    function onTextEdited(e) {
    	console.log ("text edited");
      var tb = e.subject;
      if (tb === null || !tb.name) return;
      var node = tb.part;
      if (node instanceof go.Node) {
        updateProperties(node.data);
      }
    }
 // Update the data fields when the text is changed
    function updateData(text, field) {
      var node = myDiagram.selection.first();
      // maxSelectionCount = 1, so there can only be one Part in this collection
      var data = node.data;
      if (node instanceof go.Node && data !== null) {
        var model = myDiagram.model;
        model.startTransaction("modified " + field);
        if (field === "name") {
          model.setDataProperty(data, "name", text);
        } else if (field === "title") {
          model.setDataProperty(data, "title", text);
        } else if (field === "comments") {
          model.setDataProperty(data, "comments", text);
        }
        model.commitTransaction("modified " + field);
      }
    }
 // Show the diagram's model in JSON format
    function save() {
      document.getElementById("mySavedModel").value = myDiagram.model.toJson();
      myDiagram.isModified = false;
    }
    function load() {
      myDiagram.model = go.Model.fromJson(document.getElementById("mySavedModel").value);
    }

    // These nodes have text surrounded by a rounded rectangle
    // whose fill color is bound to the node data.
    // The user can drag a node by dragging its TextBlock label.
    // Dragging from the Shape will start drawing a new link.
    myDiagram.nodeTemplate =
      $(go.Node, "Auto",
        { locationSpot: go.Spot.Center },
        $(go.Shape, "RoundedRectangle",
          {
            fill: "white", // the default fill, if there is no data-binding
            portId: "", cursor: "pointer",  // the Shape is the port, not the whole Node
            // allow all kinds of links from and to this port
            fromLinkable: true, fromLinkableSelfNode: true, fromLinkableDuplicates: true,
            toLinkable: true, toLinkableSelfNode: true, toLinkableDuplicates: true
          },
          new go.Binding("fill", "color")),
        $(go.TextBlock,
          {
            font: "bold 14px sans-serif",
            stroke: '#333',
            margin: 6,  // make some extra space for the shape around the text
            isMultiline: false,  // don't allow newlines in text
            editable: true  // allow in-place editing by user
          },
          new go.Binding("text", "text").makeTwoWay()),  // the label shows the node data's text
        { // this tooltip Adornment is shared by all nodes
          toolTip:
            $(go.Adornment, "Auto",
              $(go.Shape, { fill: "#FFFFCC" }),
              $(go.TextBlock, { margin: 4 },  // the tooltip shows the result of calling nodeInfo(data)
                new go.Binding("text", "", nodeInfo))
            ),
          // this context menu Adornment is shared by all nodes
          contextMenu: partContextMenu
        }
      );
    // Define the appearance and behavior for Links:
    function linkInfo(d) {  // Tooltip info for a link data object
      return "Link:\nfrom " + d.from + " to " + d.to;
    }
    // The link shape and arrowhead have their stroke brush data bound to the "color" property
    myDiagram.linkTemplate =
      $(go.Link,
        { relinkableFrom: true, relinkableTo: true },  // allow the user to relink existing links
        $(go.Shape,
          { strokeWidth: 2 },
          new go.Binding("stroke", "color")),
        $(go.Shape,
          { toArrow: "Standard", stroke: null },
          new go.Binding("fill", "color")),
        { // this tooltip Adornment is shared by all links
          toolTip:
            $(go.Adornment, "Auto",
              $(go.Shape, { fill: "#FFFFCC" }),
              $(go.TextBlock, { margin: 4 },  // the tooltip shows the result of calling linkInfo(data)
                new go.Binding("text", "", linkInfo))
            ),
          // the same context menu Adornment is shared by all links
          contextMenu: partContextMenu
        }
      );
    // Define the appearance and behavior for Groups:
    function groupInfo(adornment) {  // takes the tooltip or context menu, not a group node data object
      var g = adornment.adornedPart;  // get the Group that the tooltip adorns
      var mems = g.memberParts.count;
      var links = 0;
      g.memberParts.each(function(part) {
        if (part instanceof go.Link) links++;
      });
      return "Group " + g.data.key + ": " + g.data.text + "\n" + mems + " members including " + links + " links";
    }
    // Groups consist of a title in the color given by the group node data
    // above a translucent gray rectangle surrounding the member parts
    myDiagram.groupTemplate =
      $(go.Group, "Vertical",
        { selectionObjectName: "PANEL",  // selection handle goes around shape, not label
          ungroupable: true },  // enable Ctrl-Shift-G to ungroup a selected Group
        $(go.TextBlock,
          {
            font: "bold 19px sans-serif",
            isMultiline: false,  // don't allow newlines in text
            editable: true  // allow in-place editing by user
          },
          new go.Binding("text", "text").makeTwoWay(),
          new go.Binding("stroke", "color")),
        $(go.Panel, "Auto",
          { name: "PANEL" },
          $(go.Shape, "Rectangle",  // the rectangular shape around the members
            { fill: "rgba(128,128,128,0.2)", stroke: "gray", strokeWidth: 3 }),
          $(go.Placeholder, { padding: 10 })  // represents where the members are
        ),
        { // this tooltip Adornment is shared by all groups
          toolTip:
            $(go.Adornment, "Auto",
              $(go.Shape, { fill: "#FFFFCC" }),
              $(go.TextBlock, { margin: 4 },
                // bind to tooltip, not to Group.data, to allow access to Group properties
                new go.Binding("text", "", groupInfo).ofObject())
            ),
          // the same context menu Adornment is shared by all groups
          contextMenu: partContextMenu
        }
      );
    // Define the behavior for the Diagram background:
    function diagramInfo(model) {  // Tooltip info for the diagram's model
      return "Model:\n" + model.nodeDataArray.length + " nodes, " + model.linkDataArray.length + " links";
    }
    // provide a tooltip for the background of the Diagram, when not over any Part
    myDiagram.toolTip =
      $(go.Adornment, "Auto",
        $(go.Shape, { fill: "#FFFFCC" }),
        $(go.TextBlock, { margin: 4 },
          new go.Binding("text", "", diagramInfo))
      );
    // provide a context menu for the background of the Diagram, when not over any Part
    myDiagram.contextMenu =
      $(go.Adornment, "Vertical",
          makeButton("Paste",
                     function(e, obj) { e.diagram.commandHandler.pasteSelection(e.diagram.lastInput.documentPoint); },
                     function(o) { return o.diagram.commandHandler.canPasteSelection(); }),
          makeButton("Undo",
                     function(e, obj) { e.diagram.commandHandler.undo(); },
                     function(o) { return o.diagram.commandHandler.canUndo(); }),
          makeButton("Redo",
                     function(e, obj) { e.diagram.commandHandler.redo(); },
                     function(o) { return o.diagram.commandHandler.canRedo(); })
      );
    // Create the Diagram's Model:
    var nodeDataArray = [
      { key: 1, text: "Alpha", color: "lightblue", id : "agora 1" },
      { key: 2, text: "Beta", color: "orange", id : "agora 2" },
      { key: 3, text: "Gamma", color: "lightgreen", group: 5, id : "agora 3" },
      { key: 4, text: "Delta", color: "pink", group: 5, id : "agora 4" },
      { key: 5, text: "Epsilon", color: "green", isGroup: true, id : "agora 5" }
    ];
    var linkDataArray = [
      { from: 1, to: 2, color: "blue" },
      { from: 2, to: 2 },
      { from: 3, to: 4, color: "green" },
      { from: 3, to: 1, color: "purple" }
    ];
    myDiagram.model = new go.GraphLinksModel(nodeDataArray, linkDataArray);
  }
</script>

<title>Metis</title>
</head>
<body onload="init()">
	    <div data-role="popup" id="nodeObjectChange" class="ui-content" data-theme="d" style="max-width:600px;">
			<div id="popupI" class="tabela-detalhes">
			  <h3>Novo Campo</h3>
			   <div id="table-campos" >
					<div id="div-input-' + labelId +  '" class="vistoria-detalhes ui-grid-a">
						<label for="nomeCampo" class="labelInputAlign ui-block-a">Tipo</label>
						    <select name="select-tipos" id="select-tipos" class="ui-block-b"  data-mini="true">
								<option value="">Selecionar</option>
								<option value="input_texto">Texto</option>
								<option value="input_textarea">Texto Area</option>
								<option value="input_inteiro">Numérico Inteiro</option>
								<option value="input_decimal">Numérico Decimal</option>
								<option value="input_data">Data</option>
								<option value="input_cpf">CPF</option>
								<option value="input_cnpj">CNPJ</option>
								<option value="input_celular">Celular</option>
								<option value="input_telefone">Telefone</option>
								<option value="input_placa">Placa</option>
								<option value="input_checkbox">Checkbox</option>
								<option value="input_select">Seleção</option>
								<option value="input_radio">Radio</option>
								<option value="input_radio_inline">Radio mesma linha</option>
						    </select>
					</div>
					<div id="div-input-nomeCampo" class="vistoria-detalhes ui-grid-a">
						<label for="nomeCampo" class="labelInputAlign ui-block-a">Nome</label>
						<div class="ui-block-b">
                			<input type="text" name="nomeCampo" id="nomeCampo" value="" class="input-value " required  data-inline="true"/>
                		</div>	
					</div>
			   </div>
			   <fieldset id="div-Botoes" class="ui-grid-b">
					<a href="#" id="confirmaAlteracao" data-role="button" data-inline="true" data-theme="a"  class="line-button ui-block-a">Confirmar</a>
					<a href="#" id="cancelarAlteracao" data-role="button" data-inline="true" data-theme="a" class="line-button close ui-block-b">Cancelar</a>
					<a href="#" id="novoObjeto" data-role="button" data-inline="true" data-theme="a" class="line-button close ui-block-c">Novo Perfil</a>
				</fieldset>
			</div>
 	   </div>
	   <div data-role="popup" id="popupIncluiPainel" class="ui-content" data-theme="d" style="max-width:600px;">
			<div id="popupII" class="tabela-detalhes">
				<h3>Painel</h3>
				<div id="div-input-painel" class="vistoria-detalhes ui-grid-a">
					<label for="nomePainel" class="labelInputAlign ui-block-a">Nome</label>
					<div class="ui-block-b">
	           			<input type="text" name="nomePainel" id="nomePainel" value="" class="input-value " required  data-inline="true"/>
	           		</div>	
				</div>	
				<fieldset id="div-Botoes-Painel" class="ui-grid-b">
					<a href="#" id="confirmaNovoPainel" data-role="button" data-inline="true" data-theme="a"  class="line-button ui-block-b">Confirmar</a>
					<a href="#" id="cancelaNovoPainel" data-role="button" data-inline="true" data-theme="a" class="line-button close ui-block-c">Cancelar</a>
				</fieldset>
			</div>
 	   </div>
	<a id='lnkDialog' href="detalhe.html" data-rel="dialog"
		data-transition="pop" style='display: none;' hidden></a>
	<div id="conteudo-geral" data-theme="d">
		<div data-role="header" data-position="fixed">
			<h1 class="titulo-pagina">Metis</h1>
			<a href="#nav-panel" data-icon="bars" data-iconpos="notext"
				id="btn-mostra-menu">Menu</a>
		</div>
		<!-- /header -->
		<div role="main" class="ui-content jqm-content jqm-fullwidth">
			<div id="cabecalho-detalhes"></div>

			<hr class="separador" />
			<div id='swipe-acoes' class='swipe'>
				<div class='swipe-wrap'>
					<!-- content -->
					<div id="skill-1" data-role="content" class="dragme dragmeRecepcao">
						<div id="sample">
							<!-- The DIV for the Diagram needs an explicit size or else we won't see anything.
       Also add a border to help see the edges. -->
							<div id="myDiagram" style="width: 1300px; height: 600px"></div>
						</div>

					</div>
					<!-- content -->
					<div id="skill-2" data-role="content" class="dragme dragmeRecepcao">


					</div>
					<!-- content -->
					<div id="skill-2" data-role="content" class="dragme dragmeRecepcao">

					</div>
					<!-- content -->
					<div id="skill-2" data-role="content" class="dragme dragmeRecepcao">


					</div>
					<!-- content -->
					<!-- swipe-wrap -->
				</div>
				<!-- swipe-acoes -->
			</div>
			<!-- main -->
		</div>
 <textarea id="mySavedModel" style="width:100%;height:250px" hidden>
{ "class": "go.TreeModel",
  "nodeDataArray": [
{"key":"1", "name":"Stella Payne Diaz", "title":"CEO"},
{"key":"2", "name":"Luke Warm", "title":"VP Marketing/Sales", "parent":"1"},
{"key":"3", "name":"Meg Meehan Hoffa", "title":"Sales", "parent":"2"},
{"key":"4", "name":"Peggy Flaming", "title":"VP Engineering", "parent":"1"},
{"key":"5", "name":"Saul Wellingood", "title":"Manufacturing", "parent":"4"},
{"key":"6", "name":"Al Ligori", "title":"Marketing", "parent":"2"},
{"key":"7", "name":"Dot Stubadd", "title":"Sales Rep", "parent":"3"},
{"key":"8", "name":"Les Ismore", "title":"Project Mgr", "parent":"5"},
{"key":"9", "name":"April Lynn Parris", "title":"Events Mgr", "parent":"6"},
{"key":"10", "name":"Xavier Breath", "title":"Engineering", "parent":"4"},
{"key":"11", "name":"Anita Hammer", "title":"Process", "parent":"5"},
{"key":"12", "name":"Billy Aiken", "title":"Software", "parent":"10"},
{"key":"13", "name":"Stan Wellback", "title":"Testing", "parent":"10"},
{"key":"14", "name":"Marge Innovera", "title":"Hardware", "parent":"10"},
{"key":"15", "name":"Evan Elpus", "title":"Quality", "parent":"5"},
{"key":"16", "name":"Lotta B. Essen", "title":"Sales Rep", "parent":"3"}
 ]
}
    </textarea>	</div>
	<!-- conteudo-geral, snap-content -->
	</div>
</body>
</html>